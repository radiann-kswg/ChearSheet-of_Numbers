# 2026-02-15 進捗レポート

## 目的

0〜999 の各数字ページを、数学的性質だけでなく、Wikipedia の要点（要約）・文化的ないわれ・技術運用（HTTP ステータスコード、74xx ロジック番号）まで拾えるテンプレート/生成物に拡張する。

## 変更点の要約

- 数字ページのテンプレートを増強（Wikipedia要点、規格・コードの章を追加）
- 生成スクリプトを拡張し、全ページに上記章立てを自動出力
  - `100–599` は HTTP ステータスコードとしての導線（MDN + 参照リポジトリ）を追加
  - 74xx 系ロジック番号としての導線（enwiki の一覧リンク）を追加
  - 代表的なロジック番号の機能は「目安」として一部だけ自動記載（断定を避ける）
  - 文化的に有名な例として `42` に最小限の記載を追加（詳細は Wikipedia 参照）

  - リポジトリライセンスを CC BY-SA 4.0 に決定（Wikipedia 等の取り込み時のライセンス整合を取りやすくする意図）

- Wikidata（CC0）連携を追加し、ページ内容を自動拡充
  - 数そのものの Wikidata 項目（説明の要約＋リンク）
  - ISO 3166-1 numeric（3桁の国・地域コード）
  - 国番号（国際電話・E.164。数字のみの国番号に限定）
  - キャッシュ: `tools/_cache/`（Git管理しない）
  - オプション: `--no-wikidata` / `--refresh-wikidata`

- Wikipedia（日本語）連携を追加し、各数字ページの Wikipedia 冒頭（概要）を短く要約して反映
  - 方針: 長文転載を避け、冒頭1文など最小限の短い引用 + 参照リンクに留める
  - キャッシュ: `tools/_cache/`（Git管理しない）
  - オプション: `--no-wikipedia` / `--refresh-wikipedia`

- 数式（KaTeX）運用を前提に、VS Code / 指示書 / 生成を整備
  - VS Code 推奨拡張として Markdown KaTeX を追加（Markdown プレビューで `$...$` / `$$...$$` をレンダリング）
  - Copilot 指示書に KaTeX 記法のルールを明文化（`\(...\)`/`\[...\]` は使わず `$` を使う、生成物は生成側で整形、Wikipedia 引用は改変しない等）
  - 素因数分解など、既存の「指数 `^` + 乗算 `×`」表記を KaTeX に正規化して出力（例: `$2^{4} \times 59$`）
  - Wikipedia「性質」セクション由来の短い引用を追加し、数式表記が含まれる場合は **整形版（改変あり）** として KaTeX 化して掲載
    - 例: `π = 3.1415…` などを「短い引用・整形」として `「$\pi = 3.1415\dots$ …」` のように整形して記載（改変がある旨を明記）
    - Wikipedia「性質」セクションの取得はキャッシュ優先。ただし **指定した数字のうちキャッシュ欠落があれば追記取得してマージ**（部分生成でも欠落しにくくする）
      - 強制更新: `--refresh-wikipedia-sections`
    - KaTeX 整形で `re.sub` 置換文字列のバックスラッシュ扱いに起因するクラッシュを修正（例: `^3√31` → `\sqrt[3]{31}`）

- 生成時のネットワーク不安定対策として `--offline` を追加
  - キャッシュ（`tools/_cache/`）は読むが、Wikipedia/Wikidata へのネットワーク取得は行わない
  - 分割生成（`--only 0-99` 等）を連続実行してもハングしにくく、全量再生成を完走しやすい

## 影響範囲（編集したファイル）

- `_template/number.md`
- `tools/generate_numbers.py`
- `tools/wikidata_cc0.py`
- `tools/wikipedia_ja.py`
- `.github/copilot-instructions.md`
- `.vscode/extensions.json`
- `.vscode/settings.json`
- `numbers/**`（再生成）

## 未完了タスク

- 内部リンク（相対リンク）の機械的な整合チェックを追加/実行
- Wikipedia「性質」「その他」の“要点”を、必要に応じて追加で充実（全文転載は避け、要約＋参照リンク中心）
- `--wikipedia-sections` を 0..999 全件に対して使う場合の運用整理（キャッシュ構築/更新の方針、実行時間、ネットワーク不可時の扱い）
- Wikidata 連携で扱うカテゴリの追加（例: ISO 4217 numeric 等、追加する場合はプロパティID根拠を明示）

## 参考リンク

- Wikipedia（例: 31）: https://ja.wikipedia.org/wiki/31
- Wikipedia（例: 42）: https://ja.wikipedia.org/wiki/42
- 7400シリーズ一覧: https://en.wikipedia.org/wiki/List_of_7400-series_integrated_circuits
- HTTP ステータスコード チートシート: https://github.com/radiann-kswg/CheatSheet-of_HttpResponceDataCode
- Wikidata Query Service: https://query.wikidata.org/
- Wikidata データアクセス: https://www.wikidata.org/wiki/Wikidata:Data_access
