# 2026-02-17 進捗

## 目的

- Wikipedia『性質』『その他』から抽出する短い引用が、数字ページと無関係な断片になったり、ページ内の別セクションと重複して冗長になる問題を抑止する。
- macOS ローカル環境（Python 3.9 venv）で生成スクリプトが確実に動くようにする。

## 変更点の要約

- Wikipedia セクション引用の候補に「対象の数字（例: `6` / `06` / `006` / `六` / `第六` など）が含まれること」を基本条件としてフィルタし、無関係な引用を採用しにくくした。
- Wikipedia セクション引用の採用件数を `limit`（現状 3 件）に上限固定し、閾値超過で引用が大量に増える挙動を停止（ページの重複・冗長さを抑制）。
- 「科学・技術（例）」で原子番号の元素を既に提示しているため、Wikipedia『その他』側に原子番号系の引用が来た場合はスキップし、重複を回避。
- macOS/Python 3.9 で `Path.write_text(..., newline=...)` が使えず生成が落ちる問題を修正。
- VS Code タスクが venv 等の選択中 Python を使うように修正（PATH の `python` に依存しない）。

## 影響範囲（編集したファイル）

- tools/wikipedia_ja.py
- tools/generate_numbers.py
- .vscode/tasks.json

## 動作確認

- `--wikipedia-sections --refresh-wikipedia-sections --only 6,22,31,57,444` でサンプル再生成
- 内部リンクチェック: `tools/check_internal_links.py`（Missing links: 0）

## 未完了タスク

- 全件（0..999）の再生成を実行し、引用の採用結果が想定どおりかをざっとスポット確認（必要なら pins / overrides で調整）。

## 参考

- 例: numbers/0xx/006.md で無関係引用（数字不在）を除去できることを確認
