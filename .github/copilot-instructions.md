# Copilot Instructions for CheatSheet of Numbers (0-999)

## このドキュメントについて

- GitHub Copilot / AI ツールが、このリポジトリの目的・構成・執筆ルールを理解するための指示書です。
- 追加・更新する Markdown は、この指示書の命名規則とディレクトリ配置に従ってください。
- 不確かな点がある場合は、既存ファイル（特に `index.md` と `numbers/`）を探索し、ユーザーに「こういう理解で合っていますか？」と確認してください。

## 前提条件

- 回答は必ず日本語でしてください。
- 変更量が 500 行を超える可能性が高い場合は、事前に「この指示では変更量が 500 行を超える可能性がありますが、実行しますか?」と確認してください。
- 何か大きい変更（多数ファイル生成、構成変更、ルール追加など）を加える場合、まず計画を提示し「このような計画で進めようと思います。」と提案してください。
- 何か大きい変更（複数ファイルにまたがる編集、目次の大幅更新、運用ルールの追加など）を行う場合は、公開可能な範囲で `_wip/` に進捗レポートを残してください。
  - 推奨ファイル名: `YYYY-MM-DD_progress.md`
  - 最低限入れる内容: 目的 / 変更点の要約 / 影響範囲（編集したファイル）/ 未完了タスク / 参考リンク

## リポジトリ概要

このリポジトリは、0〜999 の数字について、主に次をまとめたチートシート集です。

- 数学的な性質（素因数分解・約数・トーシェント関数・表記など）
- 科学・文化に関する一次情報への導線（主に Wikipedia 等へのリンク）

## 技術スタック概要

- 形式: Markdown（静的ドキュメント）
- ビルド: なし（ただしページ生成のための補助スクリプトは同梱可）
- 依存: なし（生成は Python を利用する）

## ディレクトリ構成と役割

```
./
├── index.md                 # 入口（0〜999 目次）
├── README.md                # リポジトリ概要
├── numbers/                 # 各数字の個別ページ（基本は 1 数字 = 1 ファイル）
│   ├── 0xx/                 # 000〜099
│   ├── 1xx/                 # 100〜199
│   └── ...
├── _template/               # 執筆テンプレート
│   └── number.md
├── tools/                   # 生成・補助スクリプト
│   └── generate_numbers.py
├── _wip/                    # 作業途中メモ（公開してよい内容のみ）
└── LICENSE                  # CC BY-SA 4.0
```

## 執筆ルール（重要）

## 数式（KaTeX）記法

このリポジトリの Markdown は、VS Code 上で **KaTeX** 記法を用いて数式を記述できる前提で運用します。

- インライン数式: `$...$`
- 別行立て数式（中央寄せ）: `$$...$$`

### VS Code 側の前提

- VS Code の Markdown プレビューで KaTeX をレンダリングするため、拡張機能 **Markdown KaTeX**（`jeff-tian.markdown-katex`）を利用します。
  - リポジトリに `.vscode/extensions.json` を用意しているため、未導入の場合は推奨として表示されます。

### ルール

- 数式は原則 `$...$` / `$$...$$` で囲む（`\\(...\\)` や `\\[...\\]` は使わない）
- `numbers/` 配下の表記ゆれを避けるため、数式化が必要な表現は **生成スクリプト側で整形**する
- Wikipedia 由来の短い引用は基本は原文のまま扱う。
  - ただし **数式表記を KaTeX に整形して掲載する場合**は、原文そのままの引用ではなく「整形版（改変あり）」として扱い、引用行に `整形`（例: 「短い引用・整形」）と **改変がある旨**を明記する。
  - 原文と整形版の併記は原則不要（可読性を優先）。

### 1ファイル=1数字

- 基本: `numbers/<hundreds>xx/<3桁>.md`
  - 例: `31` → `numbers/0xx/031.md`
  - 例: `496` → `numbers/4xx/496.md`
- ファイル名は **必ず 3 桁のゼロ埋め**にしてください（リンク安定のため）。

### 生成物の扱い

- `numbers/` 配下と `index.md` / `README.md` は、原則として `tools/generate_numbers.py` で生成します。
- 内容やフォーマットを変更する場合は、個別ファイルを手編集でバラバラにするのではなく、まず生成スクリプト側の更新を優先してください（整合性維持のため）。

### 内容の方針（公開に耐えるための注意）

- Wikipedia / 解説サイト等の本文を長文で転載しない（要約＋参照リンク中心）。
- 引用する場合は短くし、出典 URL を必ず添える。
- 断定が難しい「文化的ないわれ」は、一次情報（Wikipedia 等）へのリンクを付けた上で、言い切りを避ける。
- Wikipedia は CC BY-SA です。本リポジトリも CC BY-SA 4.0 のためライセンス整合は取りやすいですが、それでも無制限の転載は避け、基本は「要約＋リンク」で扱ってください。
- Wikidata の構造化データは CC0 です。規格・コード等の“事実データ”は Wikidata 由来で自動拡充し、一次情報（Wikidata/Wikipedia）へリンクします。

### Wikidata（CC0）連携（自動拡充）

- `tools/generate_numbers.py` は Wikidata Query Service / Action API を使い、0〜999のページに以下を自動追記します（ネットワーク不可時はスキップ可）。
  - 数そのものの Wikidata 項目（説明の要約＋リンク）
  - ISO 3166-1 numeric（3桁の国・地域コード）
  - 国番号（国際電話・E.164。数字のみの国番号に限定）
- キャッシュ: `tools/_cache/`（通常はGit管理しない）
- オプション:
  - `--no-wikidata`: Wikidata 連携を無効化
  - `--refresh-wikidata`: キャッシュを更新

### Wikipedia（日本語）連携（概要の自動取得）

- `tools/generate_numbers.py` は MediaWiki API を使い、各数字ページの Wikipedia（日本語）冒頭（概要）を取得して、`Wikipedia（要点）` の箇条書きを補強します。
  - 目的: テンプレート文のままになっているページを減らしつつ、長文転載を避ける
  - 方針: **短い要約＋参照リンク**を基本とし、引用は冒頭1文など最小限に留める
- キャッシュ: `tools/_cache/`（通常はGit管理しない）
- オプション:
  - `--no-wikipedia`: Wikipedia（日本語）連携を無効化
  - `--refresh-wikipedia`: キャッシュを更新

### 追加・更新時の最低限手順

- 生成コマンド（PowerShell 例）:

```powershell
"D:/VisualStudio Code Userfile/ChearSheet-of_Numbers/.venv/Scripts/python.exe" tools/generate_numbers.py
```

- 更新後は、リポジトリ内の相対リンク（特に `index.md` → `numbers/`）がリンク切れしていないことを確認してください（外部URLは対象外でOK）。

## アンチパターン

- 既存の命名規則と異なる場所に新規ファイルを作る（例: `31.md` を `numbers/` 直下に置く）。
- 外部資料の文章をコピペして長文転載する（要約し、参照リンクを付ける）。
- `index.md` と実ファイルのリンクが不整合のまま放置される。

## ライセンス（CC BY-SA 公開のための注意）

- `LICENSE` は CC BY-SA 4.0。公開可能な内容のみを含めてください。
- 外部資料は「短い引用＋出典」または「要約＋リンク」を基本にし、転載は避けてください。
- Wikipedia 本文を取り込む場合は、CC BY-SA の要件（表示・継承・変更表示など）を満たす形で、出典 URL を明確に付けてください。
